<app-student-navbar></app-student-navbar>
<div class="container py-4">
  <div class="d-flex justify-content-between align-items-start mb-4 p-3  header">
    <div>
      <h2 class="">Welcome back, {{selectedStudentName}}</h2>
      <p class=" text-muted text">Continue your learning journey</p>
    </div>

    <div class="d-flex gap-2">
      <button class="btn btn-primary"
              [routerLink]="['/student/enrollments']"
              [queryParams]="{ studentId: selectedStudentId }">
        My Enrollments
      </button>

      <button class="btn btn-outline-secondary"
              [routerLink]="['/student/courses']"
              [queryParams]="{ studentId: selectedStudentId }">
        Browse Courses
      </button>

      <button class="btn btn-outline-secondary"
                [routerLink]="['notifications']"
                [queryParams]="{ studentId: selectedStudentId }">
          Notifications
        </button>
    </div>
  </div>

  <div class="row mb-4">
    <div class="col-md-3">
      <div class="card p-3 text-center">
        <div class="h3 mb-0">{{ enrolledCount }}</div>
        <div class="small text-muted">Enrolled Courses</div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card p-3 text-center">
        <div class="h3 mb-0">{{ learningHours }}</div>
        <div class="small text-muted">Learning Hours</div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card p-3 text-center">
        <div class="h3 mb-0">{{ certificates }}</div>
        <div class="small text-muted">Certificates</div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card p-3 text-center">
        <div class="h3 mb-0">{{ averageProgress }}%</div>
        <div class="small text-muted">Average Progress</div>
      </div>
    </div>
  </div>
  <br>
  <br>

  <div *ngIf="enrollments.length;" class="row g-4 p-3 cont">
    <h4>My Enrollments</h4>
    <div class="col-md-4" *ngFor="let e of enrollments">
      <div class="card h-100">
        <!-- <img [src]="courseFor(e)?.thumbnail || 'https://localhost:8080/'"  class="card-img-bottom" alt="thumbnail"> -->
           <img *ngIf="courseFor(e)?.thumbnail" [src]="'http://localhost:8080/' +courseFor(e)?.thumbnail" class="card-img-top" alt="thumbnail" />          <div class="card-body">


        <div class="card-body d-flex flex-column">
          <h5 class="card-title">{{ courseFor(e)?.title }}</h5>
          <p class="small text-muted mb-2">
            {{ courseFor(e)?.domain }} • {{ courseFor(e)?.level }}
            <span *ngIf="courseFor(e)?.durationHrs"> • {{ courseFor(e)?.durationHrs }}h</span>
          </p>

          <p class="small text-truncate mb-2">{{ courseFor(e)?.description }}</p>

          <div class="mt-auto">
            <div class="mb-2 small text-muted">Enrolled: {{ e.enrollmentDate }}</div>
            <div class="progress mb-2">
              <div class="progress-bar" role="progressbar" [style.width.%]="e.progress">
                {{ e.progress }}%
              </div>
            </div>

            <div class="d-flex justify-content-between align-items-center">
              <span class="badge bg-warning text-dark">{{ e.status }}</span>
              <button class="btn btn-sm btn-primary"
                      [routerLink]="['/student/player', courseFor(e)?.id]"
                      [queryParams]="{ enrollmentId: e.id }">
                Continue Learning
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <ng-template #none>
    <div class="alert alert-info">No enrollments yet.</div>
  </ng-template>
</div>
